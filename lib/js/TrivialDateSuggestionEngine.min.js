/*! Trivial Components | (c) 2015 Yann Massard and others | Apache License, Version 2.0 (https://raw.githubusercontent.com/trivial-components/trivial-components/master/LICENSE) */
var __assign=this&&this.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e};!function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports);void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd?define(["require","exports","moment"],e):(window.TrivialComponents=window.TrivialComponents||{},e(function(e){return"jquery"===e?window.jQuery:"levenshtein"===e?window.Levenshtein:"moment"===e?window.moment:"mustache"===e?window.Mustache:window.TrivialComponents},window.TrivialComponents))}(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=e("moment"),n=function(){function e(e){this.options=__assign({preferredDateFormat:"YYYY-MM-DD"},e)}return e.prototype.generateSuggestions=function(t,n){n=r(n);var i;if(t.match(/[^\d]/)){var o=t.split(/[^\d]/).filter(function(e){return!!e});i=this.createSuggestionsForFragments(o,n)}else i=this.generateSuggestionsForDigitsOnlyInput(t,n);var a=e.dateFormatToYmdOrder(this.options.preferredDateFormat);return i.sort(function(e,t){return a.indexOf(e.ymdOrder)===-1&&a.indexOf(t.ymdOrder)!==-1?1:a.indexOf(e.ymdOrder)!==-1&&a.indexOf(t.ymdOrder)===-1?-1:e.ymdOrder.length!=t.ymdOrder.length?e.ymdOrder.length-t.ymdOrder.length:e.moment.diff(n,"days")-t.moment.diff(n,"days")}),i=this.removeDuplicates(i)},e.prototype.removeDuplicates=function(e){var t=[];return e.filter(function(e){var r=t.filter(function(t){return e.moment.isSame(t,"day")}).length>0;return!r&&(t.push(e.moment),!0)})},e.dateFormatToYmdOrder=function(e){var t={D:e.indexOf("D"),M:e.indexOf("M"),Y:e.indexOf("Y")};return["D","M","Y"].sort(function(e,r){return t[e]-t[r]}).join("")},e.createSuggestion=function(e,t){return{moment:e,ymdOrder:t}},e.prototype.generateSuggestionsForDigitsOnlyInput=function(e,t){if(e=e||"",0===e.length)return this.createSuggestionsForFragments([],t);if(e.length>8)return[];for(var r=[],n=1;n<=e.length;n++)for(var i=Math.min(e.length,n+1);i<=e.length&&i-n<=4;i-n===2?i+=2:i++)r=r.concat(this.createSuggestionsForFragments([e.substring(0,n),e.substring(n,i),e.substring(i,e.length)],t));return r},e.prototype.todayOrFavoriteDirection=function(e,t){return this.options.favorPastDates?t.isSameOrAfter(e,"day"):t.isSameOrBefore(e,"day")},e.prototype.createSuggestionsForFragments=function(t,n){function i(e,t){return(e%t+t)%t}function o(e){var t=n.year()%100,r=(t+20)%100,i=100*Math.floor(n.year()/100);return e<r?i+e:e<100?i-100+e:e>n.year()-100&&e<n.year()+100?e:null}var a=this,s=t[0],u=t[1],d=t[2],f=[parseInt(s),parseInt(u),parseInt(d)],g=f[0],m=f[1],h=f[2],y=[];if(!(s||u||d)){for(var c=[],p=0;p<7;p++)c.push(e.createSuggestion(r(n).add((this.options.favorPastDates?-1:1)*p,"day"),""));return c}if(!s||u||d)if(s&&u&&!d){if(g<=12&&m>0&&m<=31){var l=this.findNextValidDate({year:n.year(),month:g-1,day:m},function(e){return{year:e.year+(a.options.favorPastDates?-1:1),month:e.month,day:e.day}},n);l&&y.push(e.createSuggestion(l,"MD"))}if(m<=12&&g>0&&g<=31){var l=this.findNextValidDate({year:n.year(),month:m-1,day:g},function(e){return{year:e.year+(a.options.favorPastDates?-1:1),month:e.month,day:e.day}},n);l&&y.push(e.createSuggestion(l,"DM"))}}else{var v=void 0;v=r([o(g),m-1,d]),v.isValid()&&y.push(e.createSuggestion(v,"YMD")),v=r([o(g),h-1,u]),v.isValid()&&y.push(e.createSuggestion(v,"YDM")),v=r([o(m),g-1,d]),v.isValid()&&y.push(e.createSuggestion(v,"MYD")),v=r([o(m),h-1,s]),v.isValid()&&y.push(e.createSuggestion(v,"DYM")),v=r([o(h),g-1,u]),v.isValid()&&y.push(e.createSuggestion(v,"MDY")),v=r([o(h),m-1,s]),v.isValid()&&y.push(e.createSuggestion(v,"DMY"))}else if(g>0&&g<=31){var l=this.findNextValidDate({year:n.year(),month:n.month(),day:g},function(e){return{year:e.year+(a.options.favorPastDates?0==e.month?-1:0:11==e.month?1:0),month:i(e.month+(a.options.favorPastDates?-1:1),12),day:e.day}},n);l&&y.push(e.createSuggestion(l,"D"))}return y},e.prototype.findNextValidDate=function(e,t,n){for(var i=e,o=r(e),a=0;(!o.isValid()||!this.todayOrFavoriteDirection(o,n))&&a<4;)i=t(i),o=r(i),a++;return o.isValid()?o:null},e}();t.TrivialDateSuggestionEngine=n});