/*! Trivial Components | (c) 2015 Yann Massard and others | Apache License, Version 2.0 (https://raw.githubusercontent.com/trivial-components/trivial-components/master/LICENSE) */
!function(t){if("object"==typeof module&&"object"==typeof module.exports){var i=t(require,exports);void 0!==i&&(module.exports=i)}else"function"==typeof define&&define.amd?define(["require","exports","jquery","moment","./TrivialEvent"],t):(window.TrivialComponents=window.TrivialComponents||{},t(function(t){return"jquery"===t?jQuery:"levenshtein"===t?Levenshtein:"moment"===t?moment:"mustache"===t?Mustache:window.TrivialComponents},window.TrivialComponents))}(function(t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var e,a=t("jquery"),s=t("moment"),n=t("./TrivialEvent");!function(t){t[t.MONDAY=1]="MONDAY",t[t.TUESDAY=2]="TUESDAY",t[t.WEDNESDAY=3]="WEDNESDAY",t[t.THURSDAY=4]="THURSDAY",t[t.FRIDAY=5]="FRIDAY",t[t.SATURDAY=6]="SATURDAY",t[t.SUNDAY=7]="SUNDAY"}(e=i.WeekDay||(i.WeekDay={}));var h=function(){function t(t,i){void 0===i&&(i={}),this.$container=t,this.onChange=new n.TrivialEvent(this),this.onOnEditingTimeUnitChange=new n.TrivialEvent(this),this.config=a.extend({selectedDate:s(),firstDayOfWeek:e.MONDAY,mode:"datetime",highlightKeyboardNavigationState:!1},i),this.keyboardNavigationState="time"==this.config.mode?"hour":"day",this.keyboardNavCssClass=this.config.highlightKeyboardNavigationState?"keyboard-nav":"",this.selectedDate=this.config.selectedDate,this.$calendarBox=a('<div class="tr-calendarbox"/>').appendTo(this.$container),this.$calendarDisplay=a('<div class="tr-calendar-display"/>'),this.$yearDisplay=a('<div class="year"><span class="back-button"/><span class="name"/><span class="forward-button"/></div>').appendTo(this.$calendarDisplay),this.$monthDisplay=a('<div class="month"><span class="back-button"/><span class="name"/><span class="forward-button"/></div>').appendTo(this.$calendarDisplay),this.$monthTable=a('<div class="month-table">').appendTo(this.$calendarDisplay),this.$year=this.$yearDisplay.find(".name"),this.$month=this.$monthDisplay.find(".name"),this.$yearDisplay.click(this.setKeyboardNavigationState.bind(this,"year")),this.$yearDisplay.find(".back-button").click(this.navigateByUnit.bind(this,"year","left",!0)),this.$yearDisplay.find(".forward-button").click(this.navigateByUnit.bind(this,"year","right",!0)),this.$monthDisplay.click(this.setKeyboardNavigationState.bind(this,"month")),this.$monthDisplay.find(".back-button").click(this.navigateByUnit.bind(this,"month","left",!0)),this.$monthDisplay.find(".forward-button").click(this.navigateByUnit.bind(this,"month","right",!0)),this.$clockDisplay=a('<div class="tr-clock-display"/>').append('<svg class="clock" viewBox="0 0 100 100" width="100" height="100"> <circle class="clockcircle" cx="50" cy="50" r="45"/> <g class="ticks" >  <line x1="50" y1="5.000" x2="50.00" y2="10.00"/> <line x1="72.50" y1="11.03" x2="70.00" y2="15.36"/> <line x1="88.97" y1="27.50" x2="84.64" y2="30.00"/> <line x1="95.00" y1="50.00" x2="90.00" y2="50.00"/> <line x1="88.97" y1="72.50" x2="84.64" y2="70.00"/> <line x1="72.50" y1="88.97" x2="70.00" y2="84.64"/> <line x1="50.00" y1="95.00" x2="50.00" y2="90.00"/> <line x1="27.50" y1="88.97" x2="30.00" y2="84.64"/> <line x1="11.03" y1="72.50" x2="15.36" y2="70.00"/> <line x1="5.000" y1="50.00" x2="10.00" y2="50.00"/> <line x1="11.03" y1="27.50" x2="15.36" y2="30.00"/> <line x1="27.50" y1="11.03" x2="30.00" y2="15.36"/> </g> <g class="numbers"> <text x="50" y="22">12</text> <text x="85" y="55">3</text> <text x="50" y="88">6</text> <text x="15" y="55">9</text> </g> <g class="hands"> <line class="minutehand" x1="50" y1="50" x2="50" y2="20"/> <line class="hourhand" x1="50" y1="50" x2="50" y2="26"/> </g> <g class="am-pm-box"> <rect x="58" y="59" width="20" height="15"/> <text class="am-pm-text" x="60" y="70" >??</text></g></svg>').append('<div class="digital-time-display"><div class="hour-wrapper"><div class="up-button"/><div class="hour">??</div><div class="down-button"/></div>:<div class="minute-wrapper"><div class="up-button"/><div class="minute">??</div><div class="down-button"/></div></div>'),this.$hourHand=this.$clockDisplay.find(".hourhand"),this.$minuteHand=this.$clockDisplay.find(".minutehand"),this.$amPmText=this.$clockDisplay.find(".am-pm-text"),this.$digitalTimeHourDisplayWrapper=this.$clockDisplay.find(".digital-time-display .hour-wrapper"),this.$digitalTimeHourDisplay=this.$clockDisplay.find(".digital-time-display .hour"),this.$digitalTimeHourDisplayWrapper.click(this.setKeyboardNavigationState.bind(this,"hour")),this.$digitalTimeHourDisplayWrapper.find(".up-button").click(this.navigateByUnit.bind(this,"hour","up",!0)),this.$digitalTimeHourDisplayWrapper.find(".down-button").click(this.navigateByUnit.bind(this,"hour","down",!0)),this.$digitalTimeMinuteDisplayWrapper=this.$clockDisplay.find(".digital-time-display .minute-wrapper"),this.$digitalTimeMinuteDisplay=this.$clockDisplay.find(".digital-time-display .minute"),this.$digitalTimeMinuteDisplayWrapper.click(this.setKeyboardNavigationState.bind(this,"minute")),this.$digitalTimeMinuteDisplayWrapper.find(".up-button").click(this.navigateByUnit.bind(this,"minute","up",!0)),this.$digitalTimeMinuteDisplayWrapper.find(".down-button").click(this.navigateByUnit.bind(this,"minute","down",!0)),"date"!=this.config.mode&&"datetime"!=this.config.mode||this.$calendarDisplay.appendTo(this.$calendarBox),"time"!=this.config.mode&&"datetime"!==this.config.mode||this.$clockDisplay.appendTo(this.$calendarBox),this.selectedDate?(this.updateMonthDisplay(this.selectedDate),this.updateClockDisplay(this.selectedDate)):(this.updateMonthDisplay(s()),this.updateClockDisplay(s()))}return t.getDaysForCalendarDisplay=function(t,i){for(var e=t.clone().utc().startOf("month").hour(12),a=e.clone().isoWeekday(i<=e.isoWeekday()?i:i-7),s=[],n=a.clone();s.length<42;n.add(1,"day"))s.push(n.clone());return s},t.prototype.updateMonthDisplay=function(i){var e=this;this.$year.text(i.year()),this.$month.text(s.months()[i.month()]),this.$monthTable.remove(),this.$monthTable=a('<div class="month-table">').appendTo(this.$calendarDisplay);for(var n=t.getDaysForCalendarDisplay(i,1),h=a("<tr>").appendTo(this.$monthTable),o=0;o<7;o++)h.append("<th>"+s.weekdaysMin()[(this.config.firstDayOfWeek+o)%7]+"</th>");for(var d=0;d<n.length/7;d++){h=a("<tr>").appendTo(this.$monthTable);for(var r=0;r<7;r++){var l=n[7*d+r],y=a("<td>"+l.date()+"</td>");l.month()==i.month()?y.addClass("current-month"):y.addClass("other-month"),l.year()==s().year()&&l.dayOfYear()==s().dayOfYear()&&y.addClass("today"),l.year()==this.selectedDate.year()&&l.dayOfYear()==this.selectedDate.dayOfYear()&&(y.addClass("selected"),"day"===this.keyboardNavigationState&&y.addClass(this.keyboardNavCssClass)),y.click(function(t){e.setKeyboardNavigationState("day"),e.setMonthAndDay(t.month()+1,t.date(),!0)}.bind(this,l)),h.append(y)}}},t.prototype.updateClockDisplay=function(t){this.$amPmText.text(t.hour()>=12?"pm":"am");var i=6*t.minute(),e=t.hour()%12+t.minute()/60,a=30*e;this.$hourHand.attr("transform","rotate("+a+",50,50)"),this.$minuteHand.attr("transform","rotate("+i+",50,50)"),this.$digitalTimeHourDisplay.text(t.format("HH")),this.$digitalTimeMinuteDisplay.text(t.format("mm"))},t.prototype.updateDisplay=function(){this.updateMonthDisplay(this.selectedDate),this.updateClockDisplay(this.selectedDate)},t.prototype.setSelectedDate=function(t){this.selectedDate=t,this.updateDisplay()},t.prototype.setYear=function(t,i){this.selectedDate.year(t),this.updateDisplay(),i&&(this.onOnEditingTimeUnitChange.fire("year"),this.fireChangeEvents("year"))},t.prototype.setMonth=function(t,i){this.selectedDate.month(t-1),this.updateDisplay(),i&&(this.onOnEditingTimeUnitChange.fire("month"),this.fireChangeEvents("month"))},t.prototype.setDayOfMonth=function(t,i){this.selectedDate.date(t),this.updateDisplay(),i&&(this.onOnEditingTimeUnitChange.fire("day"),this.fireChangeEvents("day"))},t.prototype.setMonthAndDay=function(t,i,e){this.selectedDate.month(t-1),this.selectedDate.date(i),this.updateDisplay(),e&&(this.onOnEditingTimeUnitChange.fire("day"),this.fireChangeEvents("month"),this.fireChangeEvents("day"))},t.prototype.setHour=function(t,i){this.selectedDate.hour(t),this.updateDisplay(),i&&(this.onOnEditingTimeUnitChange.fire("hour"),this.fireChangeEvents("hour"))},t.prototype.setMinute=function(t,i){this.selectedDate.minute(t),this.updateDisplay(),i&&(this.onOnEditingTimeUnitChange.fire("minute"),this.fireChangeEvents("minute"))},t.prototype.fireChangeEvents=function(t){this.$calendarBox.trigger("change"),this.onChange.fire({value:this.getSelectedDate(),timeUnitEdited:t})},t.prototype.setKeyboardNavigationState=function(t){if(this.keyboardNavigationState=t,this.config.highlightKeyboardNavigationState){var i=this;a(this.$yearDisplay).add(this.$monthDisplay).add(this.$monthTable.find("td."+this.keyboardNavCssClass)).add(this.$hourHand).add(this.$digitalTimeHourDisplayWrapper).add(this.$minuteHand).add(this.$digitalTimeMinuteDisplayWrapper).each(function(){a(this).attr("class",a(this).attr("class").replace(i.keyboardNavCssClass,""))}),"year"==this.keyboardNavigationState?this.$yearDisplay.addClass(this.keyboardNavCssClass):"month"==this.keyboardNavigationState?this.$monthDisplay.addClass(this.keyboardNavCssClass):"day"==this.keyboardNavigationState?this.$monthTable.find(".selected").addClass(this.keyboardNavCssClass):"hour"==this.keyboardNavigationState?(this.$hourHand.attr("class","hourhand "+this.keyboardNavCssClass),this.$digitalTimeHourDisplayWrapper.addClass(this.keyboardNavCssClass)):"minute"==this.keyboardNavigationState&&(this.$minuteHand.attr("class","minutehand "+this.keyboardNavCssClass),this.$digitalTimeMinuteDisplayWrapper.addClass(this.keyboardNavCssClass))}},t.prototype.getSelectedDate=function(){return this.selectedDate},t.prototype.navigateByUnit=function(t,i,e){return void 0===e&&(e=!1),"year"==t?("down"==i||"left"==i?this.setYear(this.selectedDate.year()-1,e):"up"!=i&&"right"!=i||this.setYear(this.selectedDate.year()+1,e),e&&this.fireChangeEvents("year"),!0):"month"==t?("down"==i||"left"==i?this.setMonth(this.selectedDate.month(),e):"up"!=i&&"right"!=i||this.setMonth(this.selectedDate.month()+2,e),e&&this.fireChangeEvents("month"),!0):"day"==t?("down"==i?this.selectedDate.dayOfYear(this.selectedDate.dayOfYear()+7):"left"==i?this.selectedDate.dayOfYear(this.selectedDate.dayOfYear()-1):"up"==i?this.selectedDate.dayOfYear(this.selectedDate.dayOfYear()-7):"right"==i&&this.selectedDate.dayOfYear(this.selectedDate.dayOfYear()+1),this.updateDisplay(),e&&this.fireChangeEvents("day"),!0):"hour"==t?("down"==i||"left"==i?this.setHour(this.selectedDate.hour()-1,e):"up"!=i&&"right"!=i||this.setHour(this.selectedDate.hour()+1,e),e&&this.fireChangeEvents("hour"),!0):"minute"==t?("down"==i||"left"==i?this.setMinute(this.selectedDate.minute()-this.selectedDate.minute()%5-5,e):"up"!=i&&"right"!=i||this.setMinute(this.selectedDate.minute()-this.selectedDate.minute()%5+5,e),e&&this.fireChangeEvents("minute"),!0):void 0},t.prototype.navigate=function(t){this.navigateByUnit(this.keyboardNavigationState,t)},t.prototype.getMainDomElement=function(){return this.$calendarBox[0]},t.prototype.destroy=function(){this.$calendarBox.remove()},t}();i.TrivialCalendarBox=h});